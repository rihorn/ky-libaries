// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.10/esri/copyright.txt for details.

define(["require","exports","../core/tsSupport/declareExtendsHelper","../core/tsSupport/decorateHelper","../core/lang","../core/accessorSupport/decorators","./Extent","./Geometry","./Point","./SpatialReference","./support/zmUtils"],function(t,e,r,n,a,i,s,o,p,h,l){function u(t){return function(e,r){return null==e?r:null==r?e:t(e,r)}}function c(t){return!Array.isArray(t[0])}var f=u(Math.min),y=u(Math.max),v=function(t){function e(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=t.call(this)||this;return n.paths=[],n.type="polyline",n}r(e,t),o=e,e.prototype.normalizeCtorArgs=function(t,e){var r,n,a=null,i=null;return t&&!Array.isArray(t)?(a=t.paths?t.paths:null,e||(t.spatialReference?e=t.spatialReference:t.paths||(e=t)),r=t.hasZ,n=t.hasM):a=t,a=a||[],e=e||h.WGS84,a.length&&a[0]&&null!=a[0][0]&&"number"==typeof a[0][0]&&(a=[a]),i=a[0]&&a[0][0],i&&(void 0===r&&void 0===n?(r=i.length>2,n=!1):void 0===r?r=!n&&i.length>3:void 0===n&&(n=!r&&i.length>3)),{paths:a,spatialReference:e,hasZ:r,hasM:n}},Object.defineProperty(e.prototype,"extent",{get:function(){var t=this,e=t.hasZ,r=t.hasM,n=t.spatialReference,a=t.paths,i=e?3:2;if(!a.length||!a[0].length)return null;for(var o=a[0][0],p=o[0],h=o[1],l=a[0][0],u=l[0],c=l[1],v=void 0,d=void 0,m=void 0,g=void 0,x=[],R=0;R<a.length;R++){for(var w=a[R],P=w[0],A=P[0],S=P[1],M=w[0],O=M[0],Z=M[1],_=void 0,b=void 0,z=void 0,C=void 0,I=0;I<w.length;I++){var N=w[I],J=N[0],j=N[1];if(p=f(p,J),h=f(h,j),u=y(u,J),c=y(c,j),A=f(A,J),S=f(S,j),O=y(O,J),Z=y(Z,j),e&&N.length>2){var q=N[2];v=f(v,q),d=y(d,q),_=f(_,q),b=y(b,q)}if(r&&N.length>i){var E=N[i];m=f(v,E),g=y(d,E),z=f(_,E),C=y(b,E)}}x.push(new s({xmin:A,ymin:S,zmin:_,mmin:z,xmax:O,ymax:Z,zmax:b,mmax:C,spatialReference:n}))}var F=new s;return F.xmin=p,F.ymin=h,F.xmax=u,F.ymax=c,F.spatialReference=n,e&&(F.zmin=v,F.zmax=d),r&&(F.mmin=m,F.mmax=g),F.cache._partwise=x.length>1?x:null,F},enumerable:!0,configurable:!0}),e.prototype.writePaths=function(t,e,r,n){e.paths=a.clone(this.paths)},e.prototype.addPath=function(t){if(t){this.clearCache();var e=this.paths,r=e.length;if(c(t)){for(var n=[],a=0,i=t.length;a<i;a++)n[a]=t[a].toArray();e[r]=n}else e[r]=t.concat();return this}},e.prototype.clone=function(){var t=new o;return t.spatialReference=this.spatialReference,t.paths=a.clone(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t},e.prototype.getPoint=function(t,e){if(!this._validateInputs(t,e))return null;var r=this.paths[t][e],n=this.hasZ,a=this.hasM;return n&&!a?new p(r[0],r[1],r[2],void 0,this.spatialReference):a&&!n?new p(r[0],r[1],void 0,r[2],this.spatialReference):n&&a?new p(r[0],r[1],r[2],r[3],this.spatialReference):new p(r[0],r[1],this.spatialReference)},e.prototype.insertPoint=function(t,e,r){return this._validateInputs(t,e,!0)?(this.clearCache(),l.updateSupportFromPoint(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t].splice(e,0,r),this):this},e.prototype.removePath=function(t){if(!this._validateInputs(t,null))return null;this.clearCache();var e=this.paths.splice(t,1)[0],r=this.spatialReference;return e.map(function(t){return new p(t,r)})},e.prototype.removePoint=function(t,e){return this._validateInputs(t,e)?(this.clearCache(),new p(this.paths[t].splice(e,1)[0],this.spatialReference)):null},e.prototype.setPoint=function(t,e,r){return this._validateInputs(t,e)?(this.clearCache(),l.updateSupportFromPoint(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t][e]=r,this):this},e.prototype._validateInputs=function(t,e,r){if(void 0===r&&(r=!1),null==t||t<0||t>=this.paths.length)return!1;if(null!=e){var n=this.paths[t];if(r&&(e<0||e>n.length))return!1;if(!r&&(e<0||e>=n.length))return!1}return!0},e.prototype.toJSON=function(t){return this.write(null,t)};var o;return n([i.property({dependsOn:["hasM","hasZ","paths"]})],e.prototype,"cache",void 0),n([i.property({dependsOn:["cache"],readOnly:!0})],e.prototype,"extent",null),n([i.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],e.prototype,"paths",void 0),n([i.writer("paths")],e.prototype,"writePaths",null),e=o=n([i.subclass("esri.geometry.Polyline")],e)}(i.declared(o));return v.prototype.toJSON.isDefaultToJSON=!0,v});