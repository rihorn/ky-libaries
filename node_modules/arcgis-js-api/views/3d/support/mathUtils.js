// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.10/esri/copyright.txt for details.

define(["require","exports","../../../core/libs/gl-matrix-2/gl-matrix"],function(t,n,e){function r(t){return t*Math.PI/180}function i(t){return 180*t/Math.PI}function a(t){var n=t>1?1:t<-1?-1:t;return Math.asin(n)}function o(t){var n=t>1?1:t<-1?-1:t;return Math.acos(n)}function c(t,n){return t>n?Math.cos(n):Math.cos(t)}function u(t){return 0==(t&t-1)}function f(t){--t;for(var n=1;n<32;n<<=1)t|=t>>n;return t+1}function s(t){return Math.pow(10,Math.ceil(Math.LOG10E*Math.log(t)))}function h(t,n,e){return 2*Math.atan(e*Math.tan(.5*t)/n)}function v(t,n,e){return 2*Math.atan(n*Math.tan(.5*t)/e)}function l(t){var n=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),e=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),r=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return Math.max(Math.max(n,e),r)}function M(t,n,r){r=r||t;var i=e.vec3.dot(t,n);e.vec3.set(r,t[0]-i*n[0],t[1]-i*n[1],t[2]-i*n[2]),e.vec3.normalize(r,r)}function m(t,n,r){Math.abs(t[0])>Math.abs(t[1])?e.vec3.set(n,0,1,0):e.vec3.set(n,1,0,0),e.vec3.cross(r,t,n),e.vec3.normalize(n,n),e.vec3.cross(n,r,t),e.vec3.normalize(r,r)}function p(t,n){var r=e.vec3.length(t),i=a(t[2]/r),o=Math.atan2(t[1]/r,t[0]/r);return e.vec3.set(n,r,i,o),n}function d(t,n){var r=t[0],i=t[1],a=t[2],o=Math.cos(i);e.vec3.set(n,r*o*Math.cos(a),r*o*Math.sin(a),r*Math.sin(i))}function g(t,n,e){var r=e[0]-n[0],i=e[1]-n[1],a=e[2]-n[2],o=r*r+i*i+a*a;return o?(o=1/Math.sqrt(o),t[0]=r*o,t[1]=i*o,t[2]=a*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}function y(t,n,e){return t+(n-t)*e}function b(t,n,e,r,i,a){var o=t+(n-t)*i;return o+(e+(r-e)*i-o)*a}function N(t,n,r,i){void 0===i&&(i=e.vec3f64.create());var a=e.vec3.length(t),o=e.vec3.length(n),c=e.vec3.dot(t,n)/(a*o);if(c<.9999999999999999){var u=Math.acos(c),f=(1-r)*a+r*o,s=f/Math.sin(u),h=s/a*Math.sin((1-r)*u),v=s/o*Math.sin(r*u);return e.vec3.scale(L,t,h),e.vec3.scale(k,n,v),e.vec3.add(i,L,k)}return e.vec3.lerp(i,t,n,r)}function x(t,n,r){t=e.vec3.normalize(L,t),n=e.vec3.normalize(k,n);var i=o(e.vec3.dot(t,n));if(r){var a=e.vec3.cross(C,t,n);if(e.vec3.dot(a,r)<0)return-i}return i}function P(t,n,e){return t<n?n:t>e?e:t}function w(t){var n=t.length;return function(e){if(e<=t[0][0])return t[0][1];if(e>=t[n-1][0])return t[n-1][1];for(var r=1;e>t[r][0];)r++;var i=t[r-1][0],a=t[r][0],o=(a-e)/(a-i);return o*t[r-1][1]+(1-o)*t[r][1]}}function z(t,n){if(null==t||null==n)return t!==n;if(t.length!==n.length)return!1;for(var e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function q(t,e,r){if(void 0===r&&(r=1e-6),n.isNaN(t)||n.isNaN(e))return!1;if(t===e)return!0;var i=Math.abs(t-e),a=Math.abs(t),o=Math.abs(e);if(0===t||0===e||a<1e-12&&o<1e-12){if(i>.01*r)return!1}else if(i/(a+o)>r)return!1;return!0}function F(t,e,r){return void 0===r&&(r=1e-6),!n.isNaN(t)&&!n.isNaN(e)&&(t>e?t-e:e-t)<=r}function I(t,n,r,i){e.vec3.subtract(_,n,t),e.vec3.subtract(E,r,t),e.vec3.cross(i,_,E),e.vec3.normalize(i,i),i[3]=-e.vec3.dot(t,i)}function O(t){for(var n in t){var e=t[n];e instanceof Function&&(t[n]=e.bind(t))}return t}Object.defineProperty(n,"__esModule",{value:!0}),n.deg2rad=r,n.rad2deg=i,n.asin=a,n.acos=o,n.cosCapped=c,n.sign=Math.sign||function(t){return+(t>0)-+(t<0)||+t},n.log2=Math.log2||function(t){return Math.log(t)/Math.LN2},n.isPowerOfTwo=u,n.nextHighestPowerOfTwo=f,n.nextHighestPowerOfTen=s,n.fovx2fovy=h,n.fovy2fovx=v,n.maxScale=l,n.makeOrthonormal=M,n.tangentFrame=m,n.cartesianToSpherical=p,n.sphericalToCartesian=d,n.directionFromTo=g,n.lerp=y,n.bilerp=b,n.slerp=N,n.angle=x,n.clamp=P,n.isFinite=Number.isFinite||function(t){return"number"==typeof t&&window.isFinite(t)},n.isNaN=Number.isNaN||function(t){return t!==t},n.makePiecewiseLinearFunction=w,n.vectorEquals=z,n.floatEqualRelative=q,n.floatEqualAbsolute=F;var T=function(){function t(t,n){this.min=t,this.max=n,this.range=n-t}return t.prototype.ndiff=function(t,n){return void 0===n&&(n=0),Math.ceil((t-n)/this.range)*this.range+n},t.prototype._normalize=function(t,n,e,r){return void 0===r&&(r=0),e-=r,e<t?e+=this.ndiff(t-e):e>n&&(e-=this.ndiff(e-n)),e+r},t.prototype.normalize=function(t,n){return this._normalize(this.min,this.max,t,n)},t.prototype.clamp=function(t,n){return void 0===n&&(n=0),P(t-n,this.min,this.max)+n},t.prototype.monotonic=function(t,n,e){return t<n?n:n+this.ndiff(t-n,e)},t.prototype.minimalMonotonic=function(t,n,e){return this._normalize(t,t+this.range,n,e)},t.prototype.center=function(t,n,e){return n=this.monotonic(t,n,e),this.normalize((t+n)/2,e)},t.prototype.diff=function(t,n,e){return this.monotonic(t,n,e)-t},t.prototype.contains=function(t,n,e){return n=this.minimalMonotonic(t,n),(e=this.minimalMonotonic(t,e))>t&&e<n},t}();n.Cyclical=T,n.planeFromPoints=I;var _=e.vec3f64.create(),E=e.vec3f64.create();n.cyclical2PI=O(new T(0,2*Math.PI)),n.cyclicalPI=O(new T(-Math.PI,Math.PI)),n.cyclicalDeg=O(new T(0,360));var C=e.vec3f64.create(),L=e.vec3f64.create(),k=e.vec3f64.create()});