// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.10/esri/copyright.txt for details.

/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */

define(["../../Component","dojo/i18n!../../Inputs/Tags/nls/resources"],function(t,e){return function(t){function e(s){if(n[s])return n[s].exports;var i=n[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,s){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(s,i,function(e){return t[e]}.bind(null,i));return s},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=288)}({0:function(t,e,n){"use strict";function s(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}n.d(e,"b",function(){return s}),n.d(e,"a",function(){return a});var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},a=function(){return(a=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)}},184:function(t,e,n){"use strict";e.a=function(t,e){var n=t.name;return e("li",{class:"inp-tags__tag",key:n,id:"tag-"+n},e("span",{title:n,class:"inp-tags__tag-innards"},n,e("button",{class:"inp-tags__tag-remove-btn","data-value":n,onclick:t.onRemove},e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 32 32",class:"svg-icon"},e("path",{d:"M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"})))))}},185:function(t,e,n){"use strict";var s=n(63);e.a=function(t,e){var n=t.matchingTags,i=t.onSuggestionFocus,a=t.onSuggestionBlur,o=t.onSuggestionClick,u=t.onSuggestionKeyDown;if(!t.visible)return null;var r=n.map(function(t,n){return e("li",{id:"suggestion-"+n,classes:{"inp-tags__suggestion":!0,"inp-tags__suggestion--grey":n%2==0,"inp-tags__suggestion--white":n%2!=0},"data-value":t,"data-index":n,key:t,title:t,onfocus:i,onblur:a,onmousedown:o,onkeydown:u,tabindex:"0"},t)}),g=e("div",{class:"inp-tags__no-suggestions",id:"no-matching-div"},e("h5",{class:"inp-tags__no-suggestions-text",id:"no-matching-text"},s.noTagsFound));return e("ul",{id:"tag-suggestions",class:"inp-tags__suggestions",key:"tag-suggestions"},r[0]?r:g)}},288:function(t,e,n){"use strict";n.r(e);var s=n(0),i=n(5),a=n(63),o=n(184),u=n(185),r=function(t){function e(e){var n=t.call(this,e)||this;return n.state={value:"",isFocused:!1,isTyping:!1,hasBeenFocused:!1},n.handleInputBlur=n.handleInputBlur.bind(n),n.handleInputChange=n.handleInputChange.bind(n),n.handleInputFocus=n.handleInputFocus.bind(n),n.handleInputKeyDown=n.handleInputKeyDown.bind(n),n.handleSuggestionBlur=n.handleSuggestionBlur.bind(n),n.handleSuggestionClick=n.handleSuggestionClick.bind(n),n.handleSuggestionFocus=n.handleSuggestionFocus.bind(n),n.handleSuggestionKeyDown=n.handleSuggestionKeyDown.bind(n),n.handleWidgetClick=n.handleWidgetClick.bind(n),n.spliceTag=n.spliceTag.bind(n),n}return s.b(e,t),e.prototype.render=function(t){var e=this,n=!!this.props.required&&0===this.props.activeTags.length&&this.state.hasBeenFocused&&!this.state.isTyping,s=n&&this.props.legacyValidation,i={"inp-tags__container":!0,"inp-tags__container--required-legacy":s},r={"inp-tags__active-tags":!0,"inp-tags__active-tags--focused":this.state.isFocused,"inp-tags__active-tags--required":n&&!s},g=this.props.knownTags.filter(function(t){return-1!==t.toLowerCase().indexOf(e.state.value.toLowerCase())&&-1===e.props.activeTags.indexOf(t)}),c=this.props.maxWidth?this.props.maxWidth:"auto",l=this.props.minWidth?this.props.minWidth:"auto";return t("div",{id:"tags-container",classes:i,style:"\n                        min-width: "+l+";\n                        max-width: "+c+";\n                    ",onclick:this.handleWidgetClick,"aria-label":n||s?a.required:void 0},t("ul",{classes:r,key:"active-tags",id:"active-tags"},this.props.activeTags.map(function(n){return t(o.a,{name:n,onRemove:e.spliceTag})}),t("input",{id:"tags-input",class:"inp-tags__input",placeholder:a.addTags,value:this.state.value,onkeydown:this.handleInputKeyDown,onfocus:this.handleInputFocus,onblur:this.handleInputBlur,oninput:this.handleInputChange})),n&&!s?t("div",{class:"inp-tags__required-tip"},a.required):null,t(u.a,{matchingTags:g,onSuggestionBlur:this.handleSuggestionBlur,onSuggestionClick:this.handleSuggestionClick,onSuggestionFocus:this.handleSuggestionFocus,onSuggestionKeyDown:this.handleSuggestionKeyDown,visible:this.state.isTyping}))},e.prototype.addTag=function(t){var e=this;t.split(",").forEach(function(t){var n=t.trim();n&&-1===e.props.activeTags.indexOf(n)&&e.props.onChange(e.props.activeTags.concat([n]))});var n=document.getElementById("tags-input");n&&n.focus()},e.prototype.spliceTag=function(t){var e=this.props.activeTags.slice();e.splice(this.props.activeTags.indexOf(t.target.dataset.value),1),this.props.onChange(e)},e.prototype.handleInputBlur=function(){this.setState({hasBeenFocused:!0,isFocused:!1,isTyping:!1})},e.prototype.handleInputChange=function(t){this.setState({value:t.target.value})},e.prototype.handleInputFocus=function(){this.setState({isFocused:!0})},e.prototype.handleInputKeyDown=function(t){switch(t.key){case"Enter":t.target.value&&(this.addTag(t.target.value),this.setState({value:"",isTyping:!1}),(e=document.getElementById("tags-input"))&&(e.focus(),e.value=""));break;case"Tab":var e;t.target.value&&(t.preventDefault(),this.addTag(t.target.value),this.setState({value:"",isTyping:!1}),(e=document.getElementById("tags-input"))&&(e.focus(),e.value=""));break;case"Backspace":if(!t.target.value){var n=this.props.activeTags.slice();n.pop(),this.props.onChange(n),this.setState({value:"",isTyping:!1})}break;case"Down":case"ArrowDown":var s=document.getElementById("suggestion-0");this.state.isTyping&&s&&(t.preventDefault(),s.focus());break;default:this.setState({isTyping:!0})}},e.prototype.handleSuggestionBlur=function(t){t.preventDefault(),this.setState({isFocused:!1,isTyping:!1})},e.prototype.handleSuggestionClick=function(t){t.preventDefault(),this.addTag(t.target.dataset.value),this.setState({value:"",isFocused:!0,isTyping:!1});var e=document.getElementById("tags-input");e&&(e.focus(),e.value="")},e.prototype.handleSuggestionFocus=function(t){t.preventDefault(),this.setState({isFocused:!0,isTyping:!0})},e.prototype.handleSuggestionKeyDown=function(t){switch(t.preventDefault(),t.key){case"Up":case"ArrowUp":0===t.target["data-index"]?(e=document.getElementById("tags-input"))&&e.focus():(e=document.getElementById("suggestion-"+(t.target["data-index"]-1)))&&e.focus();break;case"Down":case"ArrowDown":var e,n=document.getElementById("suggestion-"+(t.target["data-index"]+1));n?n.focus():(e=document.getElementById("suggestion-0"))&&e.focus();break;case"Tab":case"Enter":this.handleSuggestionClick(t)}},e.prototype.handleWidgetClick=function(t){var e=document.getElementById("tags-input");e&&e.focus()},e}(i.Component);e.default=r},5:function(e,n){e.exports=t},63:function(t,n){t.exports=e}})});